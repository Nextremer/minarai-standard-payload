!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["minarai-standard-payload"]=t():e["minarai-standard-payload"]=t()}(global,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.w={},r(r.s=11)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(6)),o=i(r(5)),a=i(r(4));function i(e){return e&&e.__esModule?e:{default:e}}t.default={isValidCSChatApplicationServerResponse:(0,n.default)(o.default),isValidMinaraiStandardResponseFromMinarai:(0,n.default)(a.default)}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(e){n(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Error.captureStackTrace(r,r.constructor),r.name=r.constructor.name,r}return a(t,Error),t}();t.InvalidPayloadError=function(e){function t(e){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,i),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_TYPES=void 0;var n,o=r(9),a=(n=o)&&n.__esModule?n:{default:n};t.PAYLOAD_TYPES=(0,a.default)({MINARAI_STANDARD_REQUEST:null,MINARAI_STANDARD_RESPONSE_FROM_ENGINE:null,MINARAI_STANDARD_RESPONSE_FROM_MINARAI:null,ANOI_REQUEST:null,ANOI_RESPONSE:null,GODSPEED_REQUEST:null,GODSPEED_RESPONSE:null,CSCHAT_APPLICATION_SERVER_RESPONSE:null})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){try{if(!(0,i.default.isValidMinaraiStandardResponseFromMinarai)(e))throw new o.InvalidPayloadError;var t=e.head,r=e.body,n=[],a=r.messages[0],u=a.layout,l=a.utterances,s=a.buttons,c=a.extra,f=!0,d=!1,p=void 0;try{for(var _,y=l[Symbol.iterator]();!(f=(_=y.next()).done);f=!0){var S=_.value,A=S.text,P=S.expression;n.push({type:"balloon",md:A,face:P})}}catch(e){d=!0,p=e}finally{try{!f&&y.return&&y.return()}finally{if(d)throw p}}if("image-buttons-1"===u)n.push({type:"figure",url:s[0].presentation.detail.url});else if(["horizontalButtons","verticalButtons"].includes(u)){var v=s.map(function(e){return e.presentation.detail.viewText}),O=s.map(function(e){return e.action.detail.value}).filter(Boolean);n.push({type:u,captions:v,commands:O})}return{head:t,body:{messages:[{value:{entries:n},extra:c||{}}],extra:r.extra||{}}}}catch(e){return console.log(JSON.stringify(e)),{}}};var n,o=r(1),a=r(0),i=(n=a)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={head:{engineType:String,engineName:String,requestId:String},body:{messages:Array.of({layout:String,titleText:String,utterances:Array.of({actor:[null,String],text:String,"?expression":[null,String],"?extra":{}}),"?buttons":Array.of({presentation:{type:String,detail:void 0},action:{type:String,detail:void 0},"?extra":{}}),"?extra":{}}),"?extra":{}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={head:{engineType:String,engineName:String,requestId:String},body:{messages:Array.of({value:{entries:Array.of([{type:String,md:String,"?text":String,"?face":String},{type:String,"?alt":[null,String],url:String,"?face":String},{type:String,captions:Array.of(String),commands:Array.of([null,String])},{type:String,command:String}])},"?extra":{}}),"?extra":{}}}},function(e,t){e.exports=require("js-schema")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){try{if(!(0,i.default.isValidCSChatApplicationServerResponse)(e))throw new o.InvalidPayloadError;var t=e.head,r=e.body,n=r.messages[0],a=n.value.entries.filter(function(e){return"balloon"===e.type}).map(function(e){return{actor:"",text:e.md,expression:e.face||null,extra:{}}}),u=["horizontalButtons","verticalButtons"],l=n.value.entries.find(function(e){return u.includes(e.type)}),s=["figure","file"],c=n.value.entries.find(function(e){return s.includes(e.type)}),f="chat";return l?(f=l.type,l=l.captions.map(function(e,t){return{presentation:{type:"text",detail:{viewText:e}},action:{type:"command",detail:{value:l.commands[t]}}}})):c&&(f="image-buttons-1",l=[{presentation:{type:"image",detail:{url:c.url}},action:{type:"none",detail:{}}}]),{head:t,body:{messages:[{layout:f,titleText:"",utterances:a,buttons:l,extra:n.extra||{}}],extra:r.extra||{}}}}catch(e){return console.log(JSON.stringify(e)),{}}};var n,o=r(1),a=r(0),i=(n=a)&&n.__esModule?n:{default:n}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=t.from,n=t.to;if(!r||!n)return{};if(!Object.keys(o.PAYLOAD_TYPES).includes(r)||!Object.keys(o.PAYLOAD_TYPES).includes(n))return{};try{var a=s[r][n];return a?a(e):{}}catch(e){return{}}};var o=r(2),a=u(r(7)),i=u(r(3));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=(l(n={},o.PAYLOAD_TYPES.CSCHAT_APPLICATION_SERVER_RESPONSE,l({},o.PAYLOAD_TYPES.MINARAI_STANDARD_RESPONSE_FROM_MINARAI,a.default)),l(n,o.PAYLOAD_TYPES.MINARAI_STANDARD_RESPONSE_FROM_MINARAI,l({},o.PAYLOAD_TYPES.CSCHAT_APPLICATION_SERVER_RESPONSE,i.default)),n)},function(e,t){e.exports=require("keymirror")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validator=t.convert=t.PAYLOAD_TYPES=void 0;var n=r(2),o=i(r(8)),a=i(r(0));function i(e){return e&&e.__esModule?e:{default:e}}t.PAYLOAD_TYPES=n.PAYLOAD_TYPES,t.convert=o.default,t.validator=a.default},function(e,t,r){e.exports=r(10)}])});